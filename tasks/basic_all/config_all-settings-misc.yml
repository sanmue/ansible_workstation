
# #######
# ### vim
# #######

# ----------------
# ### VIM Settings

# alt:
#- name: set vim config for user "sandro" (.vimrc) (all)
#  ansible.builtin.script: "{{ env_PWD }}/tasks/config_all-settings-misc-vim.sh" # ab ansible version 2.10, davor nur "script:"
#  args:
#    creates: "/home/{{ env_user }}/.vimrc"

# neu (via global config-file):
- name: Set (Copy) vim global config (ubuntu)
  ansible.builtin.copy:
    src: "{{ env_PWD }}/files/vimrc.local"
    dest: /etc/vim/vimrc.local
    owner: root
    group: root
    mode: '0644'
    #mode: u=rw,g=r,o=r
    backup: yes
  when:
    - ansible_distribution == "Ubuntu"


- name: Set vim global config (Archlinux)
  ansible.builtin.shell:
    cmd: "cat {{ env_PWD }}/files/vimrc.local >> /etc/vimrc"
    args:
      creates: /home/{{ env_user }}/.vimGlobalConfigDone
  when:
    - ansible_distribution == "Archlinux"

- name: Set flag for vim global config done (Archlinux)
  ansible.builtin.file:
    path: /home/{{ env_user }}/.vimGlobalConfigDone
    state: touch
    modification_time: preserve
    access_time: preserve
  when:
    - ansible_distribution == "Archlinux"


# ---------------
# ### VIM plugins

# - https://github.com/dense-analysis/ale
- name: Create folder for vim git-plugins (all)
  become: true
  become_user: "{{ env_user }}"
  ansible.builtin.shell:
    cmd: mkdir -p /home/{{ env_user }}/.vim/pack/git-plugins/start
  args:
    creates: /home/{{ env_user }}/.vim/pack/git-plugins/start

- name: Install (git clone) vim plugin - Linter ALE (all)
  become: true
  become_user: "{{ env_user }}"
  ansible.builtin.git:
    repo: https://github.com/dense-analysis/ale.git
    dest: /home/{{ env_user }}/.vim/pack/git-plugins/start
    depth: 1
